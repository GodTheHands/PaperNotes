# 灰度级分组（GLG）：优化图像对比度增强的自动方法 - 第 I 部分：基本方法

## 摘要

### 创新内容

本文介绍了一种新的自动对比度增强方法。基本过程是首先根据所选标准将低对比度图像的直方图分量分组到适当数量的分箱中，然后在灰度上均匀地重新分布这些分箱，最后取消对先前分组的灰度级的分组。因此，这种新技术被命名为灰度级分组（GLG）。

### 论文成果

GLG 不仅产生优于传统对比度增强技术的结果，而且在大多数情况下是全自动的，适用于各种图像。

## 结论

基准图像质量测量（Tenengrad 标准）表明 GLG 结果优于本文研究的常规技术的结果。

## 相关工作

对比增强在图像处理应用中具有重要作用。现已存在大量对比度增强技术，例如基于灰度变换的技术（对数变换、幂律变换、分段线性变换等）和直方图处理技术（直方图均衡（HE）、直方图规范等）。如果为给定应用选择合适的技术以及适当的处理参数，传统的对比增强技术通常会产生令人满意的结果。但是，传统对比度增强技术通常无法为各种低对比度图像产生令人满意的结果，例如，当图像的特征如下时：直方图分量的振幅在灰度上的一个或多个位置非常高，而在灰度的其余部分则非常小，但并非为零。这使得很难通过简单地拉伸其直方图或使用简单的灰度级转换来提高图像对比度。与图像背景相对应的直方图分量的高振幅通常也会阻止使用 HE 技术，这可能会对输出图像的外观造成褪色效果和/或放大背景噪声。图 1 和图 4 显示了低对比度图像的示例以及使用常规对比度增强技术处理它们的结果。

![F1](./imgs/Gray-Level Grouping (GLG) An Automatic Method  for Optimized Image Contrast Enhancement—Part I  The Basic Method/F1.jpeg)

![F23](./imgs/Gray-Level Grouping (GLG) An Automatic Method  for Optimized Image Contrast Enhancement—Part I  The Basic Method/F23.jpeg)

![F4](./imgs/Gray-Level Grouping (GLG) An Automatic Method  for Optimized Image Contrast Enhancement—Part I  The Basic Method/F4.jpeg)

图 1a 显示了火星卫星火卫一的原始低对比度图像，图 2a 显示了它的直方图。图 1b 是 HE 的结果，呈现出褪色的外观，这在许多应用中是不可接受的。褪色外观的原因是均衡图像的直方图上灰度的左半部分是空的，如图 2b 所示。图 1c 是直方图规格的结果图像，图 2c 是它的直方图，比 HE 结果要好，但外观仍然不令人满意。更重要的是，直方图规范技术的一个主要缺点是必须手动指定结果图像的所需直方图，这妨碍了该技术的自动应用。处理中使用的手动指定所需直方图如图 3 所示。图 4a 显示了行李的低对比度 X 射线图像。它在图 4b 中的 HE 结果也具有褪色的外观。

现在已经开发了许多先进的基于直方图的对比增强技术，但其中大多数是传统技术（例如 HE 等）的衍生物。例如双直方图均衡（BHE）、块重叠直方图均衡、多尺度自适应直方图均衡、形状保留局部直方图修改等。无论输入平均值如何，直方图均衡图像的平均亮度始终是中间灰度级别，这在某些需要保持亮度的应用中是不可取的。HE 的这一特性还可能导致最终图像中出现褪色的外观、放大的噪声或其他烦人的伪影。BHE 提出通过根据其平均值将输入图像的直方图分成两部分来保持亮度——一个范围从最小灰度到平均灰度，另一个从平均值到最大值。而后独立均衡两个直方图。等积二元子图像直方图均衡化（DSIHE）与 BHE 类似，不同之处在于 DSIHE 在中位灰度级别（累积概率等于 0.5 的灰度级别，而不是平均值）处分离直方图。这两种技术通常优于基本的 HE 技术。但是，它们具有与 HE 相同的局限性，无法很好地增强某些图像，因为它们仍然在每个灰度段中执行 HE 操作，只是限制了每个灰度段内 HE 的缺陷。

全局 HE 方法无法适应输入图像的局部亮度特征，因为它使用整个图像的直方图信息。这一事实限制了图像某些部分的对比度拉伸比，并导致背景和其他小区域的对比度明显损失。为了克服这一限制，一些局部直方图均衡方法被提出。全局直方图均衡化的自然扩展称为自适应直方图均衡化（AHE），它将输入图像划分为一组子图像，每个子图像独立进行直方图均衡化，然后将处理后的子图像与双线性插值融合在一起。

另一种局部方法称为块重叠直方图均衡。这个方法首先定义输入图像的矩形子图像，获得该块的直方图，然后确定其直方图均衡函数。此后，使用此函数对块的中心像素进行直方图均衡。然后，矩形块的中心移动到相邻像素，并重复直方图均衡。此过程对所有输入像素逐个像素重复。由于必须对整个图像中的所有像素执行局部直方图均衡，因此该方法的计算复杂度非常高。形状保留局部直方图修改不使用矩形块，而是使用连通分量和水平集进行对比增强。多尺度自适应直方图均衡和其他多尺度对比度增强技术使用多尺度分析将图像分解为子带，并将相应的增强技术应用于高频子带，然后将增强的高频子带与低频子带相结合，重建输出图像。

上述高级对比增强技术通常优于传统技术。但是，它们仍然存在局限性，无法很好地处理某些类别的图像和/或不是完全自动的方法。

我们的目的是开发一种新的对比度增强技术，该技术不仅可以产生更好的结果，而且是通用的，可以自动应用于各种图像。本文介绍了一种新的基于直方图的优化对比度增强技术，称为灰度级分组（GLG）。该技术的基本过程是首先根据确定标准将低对比度图像的直方图分量分成适当数量的组，然后将这些直方图分量组均匀地重新分布在灰度上，使每个组占据与其他组大小相同的灰度段，最后将先前分组的灰度级取消分组。

## 具体方法

### 基本的灰度级分组（GLG）

基本 GLG 技术的算法描述如下：

- 令 $H_n(k)$ 代表原始图像的直方图，其中 $k$ 代表在范围 $[0,M-1]$ 内的灰度等级。为了进行灰度级分组，首先将非零直方图分量分配给灰度级分项或灰度级组 $G_n(i)$
    $$
    \begin{equation}
    \begin{aligned}
    G_n(i)=H_n(k)\text{ for }H_n(k)\ne 0\\
    k=0,1,2,\ldots,M-1;\quad i=1,2,3,\ldots,n
    \end{aligned}
    \end{equation}
    $$

- 记录 $G_n(i)$ 所表示灰度区间的左右界 $L_n(i)$ 和 $R_n(i)$。在第一步中，区间由单个值组成，这些值是原始直方图分量的 $H_n(k)$ 的灰度值 $k$。
    $$
    \begin{equation}
    \begin{aligned}
    L_n(i)=R_n(i)=k,\text{ for }H_n(k)\ne 0\\
    k=0,1,2,\ldots,M-1,\quad i=1,2,3,\ldots,n
    \end{aligned}
    \end{equation}
    $$

- 找到第一个出现的 $G_n(i)$ 的最小值：
    $$
    \begin{equation}
    a=\min_{i}G_n(i)
    \end{equation}
    $$
    其中 $i_a$ 是最小的 $G_n(i)$（即 $a$）的组下标。

- 组 $G_n(i_a)$ 与其两个相邻组中较小的一个合并，并且灰度区间 $G_n(i)$ 将如下调整来创建新的组 $G_{n-1}(i)$：
    $$
    \begin{equation}
    G_{n-1}(i)=\left\{
    \begin{array}{ll}
    G_n(i),&\text{for }i=1,2,\ldots,i'-1\\
    a+b,&\text{for }i=i'\\
    G_n(i+1),&\text{for }i=i'+1,i'+2,\ldots,n-1
    \end{array}
    \right.
    \end{equation}
    $$
    其中
    $$
    \begin{equation}
    b=\min\{G_n(i_a-1),G_n(i_a+1)\}
    \end{equation}
    $$
    而且
    $$
    \begin{equation}
    i'=\left\{
    \begin{array}{ll}
    i_a-1,&\text{for }G_n(i_a-1)\le G_n(i_a+1)\\
    i_a,&\text{otherwise}.
    \end{array}
    \right.
    \end{equation}
    $$
    由 $G_{n-1}(i)$ 所代表的灰度区间的左右界也需要相应调整
    $$
    \begin{equation}
    \left.L_{n-1}(i)=\left\{\begin{array}{ll}L_n(i),&\text{for }i=1,2,\ldots,i'\\L_n(i+1),&\text{for }i=i'+1,i'+2,\ldots,n-1\end{array}\right.\right.
    \end{equation}
    $$

    $$
    \begin{equation}
    \left.R_{n-1}(i)=\left\{\begin{array}{ll}R_n(i),&\text{for }i=1,2,\ldots,i'-1\\R_n(i+1),&\text{for }i=i',i'+1,\ldots,n-1.\end{array}\right.\right.
    \end{equation}
    $$

    
